# 开发计划（里程碑拆解 + 排期）

本计划基于 `docs/prd.md` 与 `docs/plan/README.md`，将 M0/M1/M2 拆解为可执行工作包，并给出默认排期与执行方式。

---

## 1. 计划假设与约束

假设（用于排期计算）
- 迭代节奏：每个迭代 5 个工作日；每个工作包目标交付周期为 1–3 个工作日。
- 人力配置（默认）：1 名 FE（全职）+ 1 名 QA（0.5）+ 1 名 DevOps（0.2）。
- 验收方式：每个工作包有可验证验收标准（Given/When/Then）；每个里程碑有退出标准。

硬约束（来自 PRD）
- 运行时为纯静态资源：不在浏览器侧访问 WebDAV、不携带 WebDAV 凭证。
- WebDAV 仅构建期使用且只读：仅使用 `PROPFIND` 与 `GET`，禁止任何写操作。
- 凭证与敏感信息：仅存在于本地/CI 构建环境；日志与产物不得包含凭证或敏感 header。

## 2. 里程碑定义与退出标准

M0（对齐与底座）
- 退出标准：P0/P1 澄清项定稿；工程脚手架可静态构建；内容约定与校验规则明确并可自动化验证。

M1（MVP 核心）
- 退出标准：构建期从 WebDAV 生成索引与静态页面；列表/详情渲染闭环；资产策略落地；运行时不访问 WebDAV。

M2（完善与验收）
- 退出标准：标签/分类/搜索可用；移动端与可访问性通过验收；构建性能与稳定性有基线与改进；文档与发布流程可复现。

## 3. 依赖与并行策略

关键依赖（阻塞链路）
- M0 决策（SSG 技术栈、basePath、`assets/` 策略、构建触发）阻塞 M1 的实现落地。
- WebDAV 客户端（M1-T1-*）阻塞索引生成（M1-T2-*）的真实联调。
- 索引生成（M1-T2-*）阻塞页面数据接入（M1-T4-*/M1-T5-*）的真实数据渲染。

并行策略（减少阻塞）
- Track A（构建期内容通路）：先用 fixture 数据跑通索引与静态导出，再接入真实 WebDAV。
- Track B（UI 页面）：使用 fixture 的 `index.json` 先实现列表/详情/404/空态/加载态，待 M1-T2 输出稳定后再替换数据源。
- Track C（质量与安全）：从第一周开始建立日志脱敏、校验规则与测试夹具，避免后期返工。

## 4. 默认排期（6 个迭代 / 30 个工作日）

> 如需对齐具体日期，可将“迭代 0..5”映射到自然周。

### 迭代 0（M0）：决策定稿 + 工程底座

- 目标：冻结关键决策，跑通静态构建通路，并固化内容约定与校验规则清单。
- 工作包：
  - `M0-T1-*`（决策收敛与记录）
  - `M0-T2-*`（工程脚手架与静态导出验证）
  - `M0-T3-*`（内容约定与校验规则/fixture）
- 里程碑检查：按 `docs/plan/M0/README.md` 退出标准验收。

### 迭代 1（M1）：WebDAV 只读访问层（可测试、可复用）

- 目标：实现只读 WebDAV client + XML 解析 + 错误归一，并具备可离线测试夹具。
- 工作包：
  - `M1-T1-01` ~ `M1-T1-06`（见 `docs/plan/M1/work-packages.md`）
- 里程碑检查：在不连接真实 WebDAV 的情况下，基于 fixture 完成单测/集成测试。

### 迭代 2（M1）：索引生成（posts）+ 校验阻断

- 目标：构建期生成稳定的 `index.json`（或等价产物），并将内容校验接入构建门禁。
- 工作包：
  - `M1-T2-01` ~ `M1-T2-08`
- 里程碑检查：给定 50 篇文章规模的 fixture，构建耗时与排序结果可复现；校验失败可定位到文件。

### 迭代 3（M1）：Markdown 渲染管线 + 详情页闭环

- 目标：详情页可渲染 Markdown（TOC/锚点/高亮/链接/图片），并具备错误态闭环。
- 工作包：
  - `M1-T3-01` ~ `M1-T3-06`
  - `M1-T5-01` ~ `M1-T5-03`
- 里程碑检查：核心阅读体验可验收（TOC 跳转、代码高亮、图片 lazy、错误降级）。

### 迭代 4（M1）：列表页 + 分页 + 资产策略落地

- 目标：列表页可分页浏览；`assets/` 可访问；运行时保持纯静态。
- 工作包：
  - `M1-T4-01` ~ `M1-T4-05`
  - `M1-T6-*`（按 M0 决策二选一实施）
- 里程碑检查：列表->详情闭环；404/空态/加载态可用；不暴露敏感信息。

### 迭代 5（M2）：标签/分类/搜索 + 质量与文档

- 目标：完成信息架构闭环与质量验收，补齐文档与发布流程。
- 工作包：
  - `M2-T1-*`、`M2-T2-*`、`M2-T3-*`、`M2-T4-*`、`M2-T5-*`
- 里程碑检查：移动端与可访问性通过验收；构建性能有基线记录；README 可指导新环境复现构建。

## 5. 交付与质量门禁（Definition of Done）

每个工作包的 DoD
- 代码：通过 `npm run lint`；新增/变更逻辑有对应测试（单测或组件测试）。
- 安全：不引入运行时 WebDAV 访问；日志不输出敏感 header/token；产物不包含任何凭证。
- 文档：新增/变更的约定（env、内容格式、路径规则）同步到 `README.md` 或 `docs/`。

每个里程碑的 DoD
- M0：决策记录冻结；构建通路可复现；内容约定可校验。
- M1：MVP 功能闭环；静态产物可部署；核心错误态完整。
- M2：信息架构完整；移动端/可访问性/跨浏览器验收完成；文档与发布流程可复现。

